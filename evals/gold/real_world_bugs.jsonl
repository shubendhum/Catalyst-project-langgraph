{"task_id": "prod-bug-001", "category": "production_bug", "prompt": "Production incident: Users getting 500 errors on checkout. Logs show: 'float division by zero' in calculate_tax(). Fix:\n\ndef calculate_tax(subtotal, tax_rate):\n    return subtotal / tax_rate", "expected_output": {"contains": ["*", "multiply", "0.01", "if tax_rate"], "fixes": ["wrong_operator", "zero_check"], "language": "python"}, "metadata": {"difficulty": "easy", "time_limit": 10, "severity": "critical"}}
{"task_id": "prod-bug-002", "category": "production_bug", "prompt": "Memory leak in production! This WebSocket handler crashes after ~1000 connections:\n\nconnections = []\n\n@socketio.on('connect')\ndef handle_connect():\n    connections.append(request.sid)\n    \n@socketio.on('disconnect')\ndef handle_disconnect():\n    pass", "expected_output": {"contains": ["remove", "connections.remove", "cleanup", "disconnect"], "fixes": ["memory_leak", "cleanup_on_disconnect"], "language": "python"}, "metadata": {"difficulty": "medium", "time_limit": 15, "severity": "high"}}
{"task_id": "prod-bug-003", "category": "production_bug", "prompt": "Database deadlock! Multiple users updating same order causes timeout. Fix:\n\nasync def update_order(order_id, updates):\n    order = await db.orders.find_one({'_id': order_id})\n    order.update(updates)\n    await db.orders.update_one({'_id': order_id}, {'$set': order})\n    \n    # Update inventory\n    await db.inventory.update_one(\n        {'product_id': order['product_id']},\n        {'$inc': {'stock': -order['quantity']}}\n    )", "expected_output": {"contains": ["transaction", "session", "with", "start_session", "await"], "fixes": ["transaction", "atomic"], "language": "python"}, "metadata": {"difficulty": "hard", "time_limit": 25, "severity": "critical"}}
{"task_id": "prod-bug-004", "category": "production_bug", "prompt": "Customer reports: 'My shopping cart items disappear after login'. Debug this React code:\n\nfunction Cart() {\n  const [items, setItems] = useState([]);\n  const {user} = useAuth();\n  \n  useEffect(() => {\n    if (user) {\n      fetch(`/api/cart/${user.id}`)\n        .then(r => r.json())\n        .then(setItems);\n    }\n  }, [user]);\n  \n  return <div>{items.map(item => <CartItem {...item} />)}</div>;\n}", "expected_output": {"contains": ["localStorage", "merge", "persist", "guest", "migration"], "fixes": ["cart_persistence", "merge_guest_cart"], "language": "javascript"}, "metadata": {"difficulty": "hard", "time_limit": 30, "severity": "high"}}
{"task_id": "perf-001", "category": "performance", "prompt": "API response time is 5+ seconds! Optimize this endpoint:\n\n@app.get('/api/dashboard')\nasync def dashboard():\n    users = await db.users.find().to_list(None)\n    orders = await db.orders.find().to_list(None)\n    products = await db.products.find().to_list(None)\n    \n    stats = {\n        'total_users': len(users),\n        'total_orders': len(orders),\n        'total_revenue': sum(o['total'] for o in orders),\n        'top_products': sorted(products, key=lambda p: p['sales'])[-10:]\n    }\n    return stats", "expected_output": {"contains": ["aggregate", "count_documents", "index", "pipeline", "limit"], "improvements": ["aggregation", "indexes", "lazy_loading"], "language": "python"}, "metadata": {"difficulty": "hard", "time_limit": 30, "severity": "medium"}}
{"task_id": "security-002", "category": "security_vulnerability", "prompt": "Security audit found: Unauthorized users can access any file! Fix:\n\n@app.get('/api/files/{filename}')\nasync def download_file(filename: str):\n    file_path = f'/var/uploads/{filename}'\n    return FileResponse(file_path)", "expected_output": {"contains": ["user_id", "authorization", "path traversal", "validate", "belongs_to"], "fixes": ["authorization", "path_traversal"], "language": "python"}, "metadata": {"difficulty": "medium", "time_limit": 20, "severity": "critical"}}
{"task_id": "data-loss-001", "category": "data_integrity", "prompt": "Users losing data! Form submission fails silently:\n\nfunction SignupForm() {\n  const handleSubmit = async (e) => {\n    e.preventDefault();\n    const data = new FormData(e.target);\n    await fetch('/api/signup', {\n      method: 'POST',\n      body: data\n    });\n    alert('Signed up!');\n  };\n  \n  return <form onSubmit={handleSubmit}>...</form>;\n}", "expected_output": {"contains": ["try", "catch", "response.ok", "error", "status"], "fixes": ["error_handling", "response_validation"], "language": "javascript"}, "metadata": {"difficulty": "medium", "time_limit": 15, "severity": "high"}}
{"task_id": "scaling-001", "category": "scalability", "prompt": "App slows down with 100+ concurrent users. This function runs on every request:\n\ndef get_settings():\n    settings = db.settings.find().to_list(None)\n    return {s['key']: s['value'] for s in settings}", "expected_output": {"contains": ["cache", "redis", "@cache", "TTL", "invalidate"], "improvements": ["caching", "performance"], "language": "python"}, "metadata": {"difficulty": "medium", "time_limit": 20, "severity": "medium"}}
{"task_id": "mobile-001", "category": "mobile_responsive", "prompt": "Mobile users complain: 'Can't click buttons on phone'. Fix this React component:\n\nfunction ActionButtons() {\n  return (\n    <div style={{display: 'flex', gap: '5px'}}>\n      <button style={{padding: '2px', fontSize: '10px'}}>Edit</button>\n      <button style={{padding: '2px', fontSize: '10px'}}>Delete</button>\n    </div>\n  );\n}", "expected_output": {"contains": ["44px", "touch-target", "min-width", "padding", "media query"], "improvements": ["accessibility", "mobile_friendly"], "language": "javascript"}, "metadata": {"difficulty": "easy", "time_limit": 10, "severity": "low"}}
{"task_id": "timezone-001", "category": "datetime_bug", "prompt": "Bug: Event times show wrong timezone for international users. Fix:\n\ndef create_event(name, start_time):\n    event = {\n        'name': name,\n        'start_time': datetime.strptime(start_time, '%Y-%m-%d %H:%M'),\n        'created_at': datetime.now()\n    }\n    db.events.insert_one(event)\n    return event", "expected_output": {"contains": ["UTC", "timezone", "pytz", "aware", "astimezone"], "fixes": ["timezone_handling", "utc_storage"], "language": "python"}, "metadata": {"difficulty": "medium", "time_limit": 20, "severity": "medium"}}
